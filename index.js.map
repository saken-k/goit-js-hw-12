{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '47316716-03762433f8b0cf1d8516e073f';\nconst BASE_URL = 'https://pixabay.com/api/';\n\nexport async function fetchImages(query, page = 1, per_page = 15) {\n  const params = {\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: 'true',\n    page,\n    per_page,\n  };\n\n  try {\n    const response = await axios.get(BASE_URL, { params });\n    return response.data;\n  } catch (error) {\n    throw new Error(`HTTP Error: ${error.response?.status || error.message}`);\n  }\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport function clearGallery(gallery) {\n  gallery.innerHTML = '';\n}\n\nexport function renderGallery(images, gallery) {\n  const markup = images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => `\n        <li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img \n              class=\"gallery-image\" \n              src=\"${webformatURL}\" \n              alt=\"${tags}\" \n            />\n            <div class=\"info\">\n              <p><b>Likes:</b> ${likes}</p>\n              <p><b>Views:</b> ${views}</p>\n              <p><b>Comments:</b> ${comments}</p>\n              <p><b>Downloads:</b> ${downloads}</p>\n            </div>\n          </a>\n        </li>`\n    )\n    .join('');\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  const newItem = gallery.querySelector('.gallery-item');\n  const height = newItem.getBoundingClientRect().height;\n\n  return height;\n}\n\nexport function showError(message) {\n  iziToast.error({\n    message,\n    position: 'topRight',\n  });\n}\n","import { fetchImages } from './js/pixabay-api.js';\nimport {\n  clearGallery,\n  renderGallery,\n  showError,\n} from './js/render-functions.js';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMore = document.querySelector('.load-more');\n\nlet lightbox;\nlet page = 1;\nlet per_page = 15;\n\nconst STORAGE_KEY = 'query-to-pixabay';\n\nfunction toggleVisibility(element, shouldShow) {\n  element.style.display = shouldShow ? 'block' : 'none';\n}\n\nfunction resetPage() {\n  page = 1;\n}\n\ntoggleVisibility(loadMore, false);\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  const query = form.elements['image-name'].value.trim();\n  localStorage.setItem(STORAGE_KEY, JSON.stringify(query));\n  if (!query) {\n    showError('Please enter a search query!');\n    return;\n  }\n\n  resetPage();\n  clearGallery(gallery);\n  toggleVisibility(loader, true);\n\n  try {\n    const data = await fetchImages(query);\n    if (data.hits.length === 0) {\n      showError(\n        'Sorry, there are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n\n    renderGallery(data.hits, gallery);\n\n    if (lightbox) {\n      lightbox.refresh();\n    } else {\n      lightbox = new SimpleLightbox('.gallery a', {\n        captionsData: 'alt',\n        captionDelay: 250,\n        overlayOpacity: 0.8,\n      });\n    }\n\n    if (data.totalHits > page * per_page) {\n      toggleVisibility(loadMore, true);\n    } else {\n      toggleVisibility(loadMore, false);\n    }\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    showError('Something went wrong. Please try again later.');\n  }\n\n  toggleVisibility(loader, false);\n  form.reset();\n});\n\nloadMore.addEventListener('click', async () => {\n  const query = JSON.parse(localStorage.getItem(STORAGE_KEY));\n\n  toggleVisibility(loader, true);\n\n  try {\n    page += 1;\n    const data = await fetchImages(query, page, per_page);\n    const height = renderGallery(data.hits, gallery);\n\n    if (lightbox) {\n      lightbox.refresh();\n    }\n\n    if (page * per_page >= data.totalHits) {\n      toggleVisibility(loadMore, false);\n      showError(\"We're sorry, but you've reached the end of search results.\");\n    }\n\n    window.scrollBy({\n      top: height * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    showError('Something went wrong. Please try again later.');\n  }\n\n  toggleVisibility(loader, false);\n});\n"],"names":["API_KEY","BASE_URL","fetchImages","query","page","per_page","params","axios","error","_a","clearGallery","gallery","renderGallery","images","markup","largeImageURL","webformatURL","tags","likes","views","comments","downloads","showError","message","iziToast","form","loader","loadMore","lightbox","STORAGE_KEY","toggleVisibility","element","shouldShow","resetPage","event","data","SimpleLightbox","height"],"mappings":"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"}